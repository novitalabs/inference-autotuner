---
apiVersion: v1
kind: Namespace
metadata:
  name: {{ namespace }}
---
apiVersion: ome.io/v1beta1
kind: InferenceService
metadata:
  name: {{ isvc_name }}
  namespace: {{ namespace }}
  labels:
    autotuner.io/task: "{{ task_name }}"
    autotuner.io/experiment-id: "{{ experiment_id }}"
spec:
  model:
    name: {{ model_name }}
  runtime:
    name: {{ runtime_name }}
    runtimeParameters:
      tp-size: "{{ tp_size }}"
      mem-frac: "{{ mem_frac }}"{% if max_total_tokens %}
      max-total-tokens: "{{ max_total_tokens }}"{% endif %}{% if schedule_policy %}
      schedule-policy: "{{ schedule_policy }}"{% endif %}
  engine:
    minReplicas: 1
    maxReplicas: 1
    resources:
      limits:
        nvidia.com/gpu: 1
      requests:
        nvidia.com/gpu: 1
